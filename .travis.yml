language: python
python:
- '3.4'
branches:
  except:
    - master
    - ci
env:
  matrix:
    - FORMAT=hst TF=M1
    - FORMAT=hst TF=M2
    - FORMAT=hst TF=M3
    - FORMAT=hst TF=M4
    - FORMAT=hst TF=M5
    - FORMAT=hst TF=M6
    - FORMAT=hst TF=M10
    - FORMAT=hst TF=M12
    - FORMAT=hst TF=M15
    - FORMAT=hst TF=M20
    - FORMAT=hst TF=M30
    - FORMAT=hst TF=H1
    - FORMAT=hst TF=H2
    - FORMAT=hst TF=H3
    - FORMAT=hst TF=H4
    - FORMAT=hst TF=H6
    - FORMAT=hst TF=H8
    - FORMAT=hst TF=H12
    - FORMAT=hst TF=D1
    - FORMAT=hst TF=W1
    - FORMAT=hst TF=MN1
    - FORMAT=fxt TF=M1
    - FORMAT=fxt TF=M5
    - FORMAT=fxt TF=M15
    - FORMAT=fxt TF=M30
    - FORMAT=fxt TF=H1
    - FORMAT=fxt TF=H4
    - FORMAT=fxt TF=D1
    - FORMAT=fxt TF=W1
    - FORMAT=fxt TF=MN1
addons:
  apt:
    packages:
    - realpath
    - pv
notifications:
  email: false
before_install:
- set -e
install: 
before_script:
- curl -o Makefile https://raw.githubusercontent.com/FX-Data/FX-Data-Test/master/Makefile
script:
- make $FORMAT
after_success: 
after_failure:
- sudo apt-get -qy install tree && tree -d -L 6
- env
after_script:
- pwd
deploy:
  provider: releases
  api_key:
    secure: "d0TCtz3Bai9jcfwT9/2BE/UG1CnpWC7u8cquQGHmyHFEKj8Woqsm5LUPdrQFeijz++D6T3MvKjJX4kuTjAF2v7SmGnEuNFcOV93Y7Vtx8ti5U2/Xwd9W1z1mNkqwFwETFJ/Ncxy3tMhWsSQdyOIRSObi5lNl4fQKfw0BKT9AXNpSb9EwmiMVigkvJFFUMPABIptTFH6hYzujEkGvFR+hZlMaamY+UFeJV1w4ce2OKkrqIHEqc75q58PKXXqF9dn/v+/q+j7k4lpmf/11iVuX1yj1XVRZ27wpGo2pMQmhRCnhn6VdIfsjIEmpG1VvSvbZV4f4mZaK9HxrBO5mAC1yZRLuipuwW6YaZHH86qE+z3q7oiDACbmLr2g+vXfWKCr0HKRlJOq0sT9w+KNqhXSTWuO2mkn874dSVfkBt8gwf7lPD7OFnvM2R8AIS9QYuScB0KZCsIms8kjHVRHHW0Pa1fa/zr6fWVeFI+B2kxxB1+ms2Y+BsaUAjGtjqvn8aNrS8lvkYAr0pE8JDX+LoOtOsducqpA9ty+pdwKNyU5nll9gdirCJmkXo5E9DrcVUWPvApl4zuc9EcWcnakL7iIK+eJpk5g4D3ve//Tfg9z/63cioqoPntoNF6tK7feNhMy2yPLliH9oc6lv+iv55t9lU2jyqVMIT3QVgA2ocfHg0E4="
  file:
    - "*.hst.gz"
    - "*.fxt.gz"
  file_glob: true
  skip_cleanup: true
  overwrite: true
  on:
    repo: FX-Data/FX-Data-USDNOK-DS
    tags: true
after_deploy:
- make clean
